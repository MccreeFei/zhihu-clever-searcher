<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.mccreefei.zhihu.dao.mapper.AnswerMapper">
    <resultMap id="AnswerMap" type="cn.mccreefei.zhihu.dao.domain.AnswerWithUserDo">
        <result column="question_id" property="questionId" jdbcType="INTEGER" />
        <result column="answer_id" property="answerId" jdbcType="INTEGER" />
        <result column="character_url" property="characterUrl" jdbcType="VARCHAR" />
        <result column="answer_url" property="answerUrl" jdbcType="VARCHAR" />
        <result column="question_title" property="questionTitle" jdbcType="VARCHAR" />
        <result column="text_agrees" property="textAgrees" jdbcType="INTEGER" />
        <result column="text_comments" property="textComments" jdbcType="INTEGER" />
        <result column="head_url" property="headUrl" jdbcType="VARCHAR" />
        <result column="user_name" property="userName" jdbcType="VARCHAR" />
        <result column="simple_description" property="simpleDescription" jdbcType="VARCHAR" />
        <result column="user_thanks" property="userThanks" jdbcType="INTEGER" />
        <result column="user_collects" property="userCollects" jdbcType="INTEGER" />
        <result column="user_agrees" property="userAgrees" jdbcType="INTEGER" />
        <result column="user_followers" property="userFollowers" jdbcType="INTEGER" />
        <result column="user_followees" property="userFollowees" jdbcType="INTEGER" />
    </resultMap>

    <select id="getAnswerInfo" parameterType="cn.mccreefei.zhihu.dao.domain.AnswerWithUserDo"
            resultMap="AnswerMap">
        select answer.question_id, answer.answer_id, answer.answer_url, answer.question_title,
        answer.agrees as text_agrees, answer.comments as text_comments,
          user.character_url, user.head_url, user.user_name, user.simple_description, user.thanks as user_thanks,
          user.collects as user_collects, user.agrees as user_agrees, user.followers as user_followers, user.followees as user_followees
        from zhihu_answer answer left join zhihu_user user on answer.character_url = user.character_url
        <where>
            <if test="questionId != null">
                answer.question_id = #{questionId}
            </if>
            <if test="answerId != null">
                and answer.answer_id = #{answerId}
            </if>
        </where>
    </select>

</mapper>
