<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.mccreefei.zhihu.dao.mapper.ArticleMapper">
    <resultMap id="ArticleMap" type="cn.mccreefei.zhihu.dao.domain.ArticleWithUserDo">
        <result column="article_id" property="articleId" jdbcType="INTEGER" />
        <result column="character_url" property="characterUrl" jdbcType="VARCHAR" />
        <result column="article_url" property="articleUrl" jdbcType="VARCHAR" />
        <result column="article_title" property="articleTitle" jdbcType="VARCHAR" />
        <result column="text_agrees" property="textAgrees" jdbcType="INTEGER" />
        <result column="text_comments" property="textComments" jdbcType="INTEGER" />
        <result column="head_url" property="headUrl" jdbcType="VARCHAR" />
        <result column="user_name" property="userName" jdbcType="VARCHAR" />
        <result column="simple_description" property="simpleDescription" jdbcType="VARCHAR" />
        <result column="user_thanks" property="userThanks" jdbcType="INTEGER" />
        <result column="user_collects" property="userCollects" jdbcType="INTEGER" />
        <result column="user_agrees" property="userAgrees" jdbcType="INTEGER" />
        <result column="user_followers" property="userFollowers" jdbcType="INTEGER" />
        <result column="user_followees" property="userFollowees" jdbcType="INTEGER" />
    </resultMap>

    <select id="getArticleInfo" parameterType="cn.mccreefei.zhihu.dao.domain.ArticleWithUserDo"
            resultMap="ArticleMap" >
        select article.article_id, article.article_url, article.article_title, article.agrees as text_agrees,
           article.comments as text_comments, user.character_url, user.head_url, user.user_name, user.simple_description,
           user.thanks as user_thanks, user.collects as user_collects, user.agrees as user_agrees,
           user.followers as user_followers, user.followees as user_followees
        from zhihu_article article left join zhihu_user user on article.character_url = user.character_url
        <where>
            <if test="articleId != null">
                article.article_id = #{articleId}
            </if>
        </where>
    </select>

</mapper>
